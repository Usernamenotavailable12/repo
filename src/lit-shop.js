var E=Object.freeze,F=Object.defineProperty;var R=(l,e,t)=>e in l?F(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var y=(l,e,t)=>R(l,typeof e!="symbol"?e+"":e,t);var d=(l,e)=>E(F(l,"raw",{value:E(e||l.slice())}));function Y(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const{LitElement:P,html:c,css:J}=window.Lit;var N,B,S,V,j,M,T,D,G,U,z,q,L;class x extends P{constructor(){super(),this.items=[],this.selectedOptions={},this.loading=!1,this.errorMessages={},this.locale="en",this.shopItemCategoryId="",this.dropdownOpen={},this.fetchError=null,this.translations={en:{buy:"Buy",notEnoughCoins:"Not Enough Coins",betValue:"Bet Value",amount:"Amount",loggIn:"Log In",FreespinAmount:"Freespin Amount",FreespinValue:"Freespin Value",fetchError:"Failed to load items",unknownItem:"Unknown Item"},ka:{buy:"გადაცვლა",notEnoughCoins:"არასაკმარისი მონეტები",betValue:"ნომინალი",amount:"რაოდენობა",loggIn:"შესვლა",FreespinAmount:"სპინების რაოდენობა",FreespinValue:"სპინების ნომინალი",fetchError:"ვერ მოხერხდა ნივთების ჩატვირთვა",unknownItem:"უცნობი ნივთი"},ru:{buy:"Купить",notEnoughCoins:"Недостаточно монет",betValue:"Значение ставки",amount:"Количество",loggIn:"Войти",FreespinAmount:"Freespin Количество",FreespinValue:"Freespin Ценить",fetchError:"Не удалось загрузить элементы",unknownItem:"Неизвестный элемент"},tr:{buy:"Satın Al",notEnoughCoins:"Yetersiz Jeton",betValue:"Bahis Değeri",amount:"Miktar",loggIn:"Giriş Yap",FreespinAmount:"Freespin Miktar",FreespinValue:"Freespin Değer",fetchError:"Öğeler yüklenemedi",unknownItem:"Bilinmeyen Öğe"}}}connectedCallback(){super.connectedCallback(),this.shopItemCategoryId&&this.fetchItems()}async fetchItems(){var t,s;this.loading=!0,this.fetchError=null;const e='query ShopItemConnection {\n      shopItemConnection(\n        shopItemCategoryId: "'.concat(this.shopItemCategoryId,'",\n        orderBy: [\n          {\n            field: order,\n            direction: ASCENDING\n          }\n        ],\n        status: ACTIVE\n      ) {\n        edges {\n          node {\n            price { value }\n            id\n            actions {\n              ... on GiveBonusAction {\n                bonus {\n                  reward {\n                    __typename\n                    ... on FreespinsBonusReward {\n                      amount\n                      games { slug studio }\n                      betValue { value }\n                    }\n                    ... on FixedBonusReward {\n                      amounts {\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n              ... on GiveAndActivateBonusAction {\n                bonus {\n                  reward {\n                    __typename\n                    ... on FreespinsBonusReward {\n                      amount\n                      games { slug studio }\n                      betValue { value }\n                    }\n                    ... on FixedBonusReward {\n                      amounts {\n                        value\n                      }\n                    }\n                  }\n                }\n              }\n              ... on GiveBoxAction {\n                box {\n                  description\n                  type\n                }\n              }\n              __typename\n            }\n          }\n        }\n      }\n    }');try{const a=await(await fetch("https://www.ambassadoribet.com/_internal/gql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})})).json();if(a.errors)throw new Error(a.errors[0].message);if(!((s=(t=a.data)==null?void 0:t.shopItemConnection)!=null&&s.edges))throw new Error("Invalid response structure");this.items=this.groupItemsBySlug(a.data.shopItemConnection.edges)}catch(r){this.fetchError=this.translations[this.locale].fetchError}finally{this.loading=!1,this.requestUpdate()}}groupItemsBySlug(e){const t={};return e.forEach(({node:s},r)=>{var p,u,m,h,b,f,o,g,v,k,I,$,A,O,C;const a=(p=s.actions)==null?void 0:p[0];if(!a)return;let i,n;if((a.__typename==="GiveBonusAction"||a.__typename==="GiveAndActivateBonusAction")&&((m=(u=a.bonus)==null?void 0:u.reward)==null?void 0:m.__typename)==="FreespinsBonusReward"){const{slug:w,studio:_}=((h=a.bonus.reward.games)==null?void 0:h[0])||{};if(!w||!_)return;i=w,t[i]||(t[i]={type:"freespins",slug:w,studio:_,items:[],betValues:new Set,amounts:new Set}),n={id:s.id,price:((b=s.price)==null?void 0:b.value)||0,betValue:((f=a.bonus.reward.betValue)==null?void 0:f.value)||0,amount:a.bonus.reward.amount||0},t[i].betValues.add(n.betValue),t[i].amounts.add(n.amount)}else(a.__typename==="GiveBonusAction"||a.__typename==="GiveAndActivateBonusAction")&&((g=(o=a.bonus)==null?void 0:o.reward)==null?void 0:g.__typename)==="FixedBonusReward"?(i="fixed-".concat(s.id,"-").concat(r),n={type:"fixed",id:s.id,price:((v=s.price)==null?void 0:v.value)||0,amount:((I=(k=a.bonus.reward.amounts)==null?void 0:k[0])==null?void 0:I.value)||0}):a.__typename==="GiveBoxAction"?(i="box-".concat(s.id,"-").concat(r),n={type:"box",id:s.id,price:(($=s.price)==null?void 0:$.value)||0,boxType:((A=a.box)==null?void 0:A.type)||"UNKNOWN",description:((O=a.box)==null?void 0:O.description)||"No description"}):(i="unknown-".concat(s.id,"-").concat(r),n={type:"unknown",id:s.id,price:((C=s.price)==null?void 0:C.value)||0,description:"Unknown Item"});i&&n&&(t[i]||(t[i]={type:n.type,items:[]}),t[i].items.push(n))}),Object.values(t)}async purchaseItem(e,t){this.loading=!0,this.errorMessages={...this.errorMessages,[t]:""},this.requestUpdate();const s="mutation PurchaseShopItems($input: PurchaseShopItemsInput!) {\n      purchaseShopItems(input: $input) {\n        shopTransaction {\n          userId\n          shopItems { id }\n        }\n      }\n    }";try{const r=extractAuthDataFromCookie();if(!r||!r.accessToken)throw TMA.execute("LOGIN_CONNECTED"),new Error("Unable to retrieve authorization data.");const i=await(await fetch("https://www.ambassadoribet.com/_internal/gql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.accessToken)},body:JSON.stringify({query:s,variables:{input:{shopItemIds:[e]}}})})).json();if(i.errors)i.errors[0].message==="NOT_ENOUGH_MONEY"?this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].notEnoughCoins}:i.errors[0].message==="FORBIDDEN"?(TMA.execute("LOGIN_CONNECTED"),this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].loggIn}):this.errorMessages={...this.errorMessages,[t]:"Purchase failed"},setTimeout(()=>{this.errorMessages={},this.requestUpdate()},1e3);else if(i.data.purchaseShopItems){const n=this.shadowRoot.querySelector("#buy-".concat(t));n&&(n.classList.add("success"),setTimeout(()=>{n.classList.remove("success")},3e3))}}catch(r){this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].loggIn},setTimeout(()=>{this.errorMessages={},this.requestUpdate()},1e3)}finally{this.loading=!1,this.requestUpdate()}}handleFilterChange(e,t,s){this.selectedOptions={...this.selectedOptions,[e]:{...this.selectedOptions[e],[t]:s}},this.dropdownOpen={...this.dropdownOpen,[e]:!1},this.requestUpdate()}toggleDropdown(e){const t={};Object.keys(this.dropdownOpen).forEach(s=>{t[s]=!1}),t[e]=!this.dropdownOpen[e],this.dropdownOpen=t,this.requestUpdate()}getSelectedItem(e){if(e.type!=="freespins")return e.items[0];const t=this.selectedOptions[e.slug]||{},s=t.betValue||[...e.betValues][0],r=t.amount||[...e.amounts][0];return e.items.find(a=>a.betValue===s&&a.amount===Number(r))||e.items[0]}render(){return this.fetchError?c(B||(B=d(['<div class="error-card">',"</div>"])),this.fetchError):!this.items.length&&!this.loading?c(S||(S=d(['<div class="error-card">No items available</div>']))):c(L||(L=d(['\n      <div class="shop-container">\n        ',"\n      </div>\n    "])),this.items.map(e=>{var t,s,r,a,i,n,p,u,m,h,b,f;return c(q||(q=d(['\n            <div class="card">\n              ','\n              <button\n                id="buy-','"\n                class="buy-button"\n                ?disabled="','"\n                @click="','"\n              >\n                ',"\n                ","\n              </button>\n              ","\n            </div>\n          "])),e.type==="freespins"?c(T||(T=d(['\n                    <img\n                      src="https://game-assets-tma1-prd.themill.tech/cdn-cgi/image/f=avif,f=auto,w=512,h=288/tm/',"/",'-1024x576?dpr=1&auto=format&fit=max"\n                      alt="','"\n                    />\n                    <div class="card-content">\n                      <h3\n                        style="margin-block: .8rem; color: rgba(255, 255, 255, 1); font-family: \'Noto Sans Ambassadori Bold\'; text-align: center;"\n                      >\n                        ','\n                      </h3>\n                      <div class="filters">\n                        <span class="FreespinAmount">','</span>\n                        <div\n                          @change="','"\n                        >\n                          ','\n                        </div>\n                        <span class="FreespinValue">','</span>\n                        <div class="custom-dropdown">\n                          <div\n                            class="dropdown-button"\n                            @click="','"\n                          >\n                            <span>\n                              ',"\n                            </span>\n                            <span>▼</span>\n                          </div>\n                          ","\n                        </div>\n                      </div>\n                    </div>\n                  "])),(t=e.studio)==null?void 0:t.toLowerCase().replace(/_/g,"-"),e.slug,e.slug||"Game",((s=e.slug)==null?void 0:s.replace(/-/g," ").replace(/\b\w/g,o=>o.toUpperCase()))||"Unknown Game",this.translations[this.locale].FreespinAmount,o=>this.handleFilterChange(e.slug,"amount",o.target.value),[...e.amounts||[]].map(o=>{var g;return c(V||(V=d(['\n                              <input\n                                style="display: none;"\n                                id="',"-",'"\n                                type="radio"\n                                name="amount-','"\n                                value="','"\n                                ?checked="','"\n                              />\n                              <label\n                                class="amount-selector"\n                                for="',"-",'"\n                              >\n                                ',"\n                              </label>\n                            "])),e.slug,o,e.slug,o,((g=this.selectedOptions[e.slug])==null?void 0:g.amount)===o,e.slug,o,o)}),this.translations[this.locale].FreespinValue,()=>this.toggleDropdown(e.slug),((r=this.selectedOptions[e.slug])==null?void 0:r.betValue)||this.translations[this.locale].betValue,this.dropdownOpen[e.slug]?c(M||(M=d(['\n                                <div class="dropdown-list">\n                                  ',"\n                                </div>\n                              "])),[...e.betValues||[]].map(o=>c(j||(j=d(['\n                                      <div\n                                        class="dropdown-item"\n                                        @click="','"\n                                      >\n                                        '," ₾\n                                      </div>\n                                    "])),()=>this.handleFilterChange(e.slug,"betValue",o),o))):""):e.type==="fixed"?c(D||(D=d(['\n                    <div class="reward-container fixed-bonus">\n                      ',' ₾\n                    </div>\n                    <div class="card-content">\n                    </div>\n                  '])),((a=e.items[0])==null?void 0:a.amount)||0):e.type==="box"?c(G||(G=d(['\n                    <div class="reward-container ','">\n                    </div>\n                    <div class="card-content">\n                    <h3\n                        style="margin-block: .8rem; color: rgba(255, 255, 255, 1); font-family: \'Noto Sans Ambassadori Bold\'; text-align: center;"\n                      >\n                      ',"\n                      </h3>\n                    </div>\n                  "])),((n=(i=e.items[0])==null?void 0:i.boxType)==null?void 0:n.toLowerCase().replace(/_/g,"-"))||"unknown",((p=e.items[0])==null?void 0:p.description)||"No description"):c(U||(U=d(['\n                    <div class="reward-container unknown">\n                      ','\n                    </div>\n                    <div class="card-content">\n                    </div>\n                  '])),((u=e.items[0])==null?void 0:u.description)||"Unknown Item"),e.type==="freespins"?e.slug:(m=e.items[0])==null?void 0:m.id,this.loading||!this.getSelectedItem(e),()=>{const o=this.getSelectedItem(e);o&&this.purchaseItem(o.id,e.type==="freespins"?e.slug:e.items[0].id)},this.translations[this.locale].buy,((h=this.getSelectedItem(e))==null?void 0:h.price)||"N/A",this.errorMessages[e.type==="freespins"?e.slug:(b=e.items[0])==null?void 0:b.id]?c(z||(z=d(['\n                    <div class="error-text">\n                      ',"\n                    </div>\n                  "])),this.errorMessages[e.type==="freespins"?e.slug:(f=e.items[0])==null?void 0:f.id]):"")}))}}y(x,"styles",J(N||(N=d(['\n    :host {\n      display: block;\n      padding: 16px;\n    }\n    .shop-container {\n      display: grid;\n      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));\n      gap: 16px;\n    }\n    @media (max-width: 1200px) {\n      .shop-container {\n        grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));\n      }\n    }\n    .card {\n      border-radius: 12px;\n      overflow: hidden;\n      background: #3d0235c7;\n      backdrop-filter: blur(10px);\n      -webkit-backdrop-filter: blur(10px);\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n      padding: 10px;\n    }\n    .card img {\n      width: 100%;\n      height: auto;\n      object-fit: cover;\n      border-radius: 8px;\n    }\n    .card-content {\n      padding: 0px 6px 6px 6px;\n    }\n    .filters {\n      margin-bottom: 16px;\n      display: flex;\n      gap: 8px;\n      flex-wrap: wrap;\n      justify-content: center;\n      width: 100%;\n      flex-direction: column;\n      > div {\n        gap: 8px;\n        display: flex;\n        flex-wrap: wrap;\n        flex: 1 1 0;\n      }\n      .amount-selector {\n        color: white;\n        padding: 10px;\n        border-radius: 8px;\n        background-color: rgba(38, 40, 61, 1);\n        opacity: 0.5;\n        flex: 1;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        text-align: center;\n        cursor: pointer;\n      }\n    }\n    input:checked + .amount-selector {\n      background-color: rgba(38, 40, 61, 1);\n      opacity: 1;\n    }\n    .custom-dropdown {\n      position: relative;\n      width: 100%;\n      .dropdown-button {\n        padding: 8px 12px;\n        border-radius: 14px;\n        font-family: "Noto Sans Ambassadori";\n        color: white;\n        background: #26283D;\n        border: 2px solid rgba(71, 47, 80, 1);\n        cursor: pointer;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        flex: 1;\n      }\n    }\n    .dropdown-list {\n      position: absolute;\n      bottom: 100%;\n      left: 0;\n      right: 0;\n      background: #26283dbe;\n      border-radius: 8px;\n      border: 2px solid rgba(71, 47, 80, 1);\n      backdrop-filter: blur(10px);\n      -webkit-backdrop-filter: blur(10px);\n      margin-top: 4px;\n      z-index: 10;\n      max-height: 200px;\n      overflow-y: auto;\n    }\n    .dropdown-item {\n      padding: 8px;\n      color: white;\n      cursor: pointer;\n      font-family: "Noto Sans Ambassadori";\n    }\n    .dropdown-item:hover {\n      background: #CF167D;\n    }\n    .buy-button {\n      width: 100%;\n      padding: 5px;\n      border: solid 2px rgba(207, 22, 125, 1);\n      border-radius: 64px;\n      background: linear-gradient(\n        135deg,\n        rgba(223, 4, 150, 0.77),\n        rgba(14, 4, 74, 0.77)\n      );\n      background-size: 200% 200%;\n      color: white;\n      cursor: pointer;\n      font-size: 16px;\n      font-family: "Noto Sans Ambassadori";\n      transition: background-position 0.6s ease;\n    }\n    .buy-button:hover {\n      background-position: 100% 100%;\n    }\n    .buy-button:disabled {\n      background: #ccc;\n      cursor: not-allowed;\n    }\n    .buy-button.success {\n      background: #28a745;\n    }\n    .error-text {\n      color: red;\n      font-size: 12px;\n      margin-top: 4px;\n      text-align: center;\n      font-family: "Noto Sans Ambassadori";\n    }\n    .FreespinValue,\n    .FreespinAmount {\n      color: rgba(255, 255, 255, 0.77);\n      font-size: 12px;\n      font-family: "Noto Sans Ambassadori";\n    }\n    .reward-container {\n      width: 100%;\n      height: 144px;\n      border-radius: 8px;\n      position: relative;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      font-family: "Noto Sans Ambassadori";\n      font-size: 24px;\n      font-weight: bold;\n      text-align: center;\n    }\n    .fixed-bonus {\n      background: url(\'https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/049a4a19-77e4-43c8-9a5f-065dd4f04896/promotion.jpg?auto=format%2Ccompress\') center/cover no-repeat;\n      font-size: 34px;\n      text-shadow:\n  1px 1px 2px red,\n  0 0 1em gold,\n  0 0 0.2em gold;\n    }\n    .loot-box {\n      background: url(\'https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/bc1b3327-fccc-4c28-a3cd-a23cfa102888/BOX-5.jpg?auto=format%2Ccompress\') center/cover no-repeat;\n      font-size: 14px;\n      align-items: start;\n      justify-content: start;\n    }\n    .mystery-box {\n      background: url(\'https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/bc1b3327-fccc-4c28-a3cd-a23cfa102888/BOX-5.jpg?auto=format%2Ccompress\') center/cover no-repeat;\n      font-size: 14px;\n      align-items: start;\n      justify-content: start;\n    }\n    .wheel-of-fortune {\n      background: url(\'https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/431be0d0-483d-413c-9ea0-bf13045890fa/WHEEL-1.jpg?auto=format%2Ccompress\') center/cover no-repeat;\n      font-size: 14px;\n      align-items: start;\n      justify-content: start;\n    }\n    .unknown {\n      background: url(\'https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/bc1b3327-fccc-4c28-a3cd-a23cfa102888/BOX-5.jpg?auto=format%2Ccompress\') center/cover no-repeat;\n      font-size: 14px;\n      align-items: start;\n      justify-content: start;\n    }\n    .error-card {\n      color: red;\n      text-align: center;\n      padding: 20px;\n    }\n  '])))),y(x,"properties",{items:{type:Array},selectedOptions:{type:Object},loading:{type:Boolean},errorMessages:{type:Object},locale:{type:String},shopItemCategoryId:{type:String,attribute:!0},dropdownOpen:{type:Object},fetchError:{type:String}});customElements.define("shop-component",x);export{Y as __vite_legacy_guard};
//# sourceMappingURL=shop-2.js.map
