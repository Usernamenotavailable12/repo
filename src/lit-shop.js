var h=Object.freeze,p=Object.defineProperty;var w=(o,e,t)=>e in o?p(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var d=(o,e,t)=>w(o,typeof e!="symbol"?e+"":e,t);var i=(o,e)=>h(p(o,"raw",{value:h(e||o.slice())}));function k(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const{LitElement:v,html:c,css:I}=window.Lit;var g,m,b,f,x,y;class u extends v{constructor(){super(),this.items=[],this.selectedOptions={},this.loading=!1,this.errorMessages={},this.locale="en",this.translations={en:{buy:"Buy",notEnoughCoins:"Not Enough Coins",betValue:"Bet Value",amount:"Amount",loggIn:"Log In"},ka:{buy:"ყიდვა",notEnoughCoins:"არასაკმარისი მონეტები",betValue:"ნომინალი",amount:"რაოდენობა",loggIn:"შესვლა"},ru:{buy:"Купить",notEnoughCoins:"Недостаточно монет",betValue:"Значение ставки",amount:"Количество",loggIn:"Войти"},tr:{buy:"Satın Al",notEnoughCoins:"Yetersiz Jeton",betValue:"Bahis Değeri",amount:"Miktar",loggIn:"Giriş Yap"}}}connectedCallback(){super.connectedCallback(),this.fetchItems()}async fetchItems(){const e='query ShopItemConnection {\n      shopItemConnection(\n        shopItemCategoryId: "EaSWdQhNv4QlgYY38yut",\n        orderBy: [\n          {\n            field: order,\n            direction: ASCENDING\n          }\n        ],\n        status: ACTIVE\n      ) {\n        edges {\n          node {\n            price { value }\n            id\n            actions {\n              ... on GiveBonusAction {\n                bonus {\n                  reward {\n                    ... on FreespinsBonusReward {\n                      amount\n                      games { slug studio }\n                      betValue { value }\n                    }\n                  }\n                }\n              }\n              ... on GiveAndActivateBonusAction {\n                bonus {\n                  reward {\n                    ... on FreespinsBonusReward {\n                      amount\n                      games { slug studio }\n                      betValue { value }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }';try{const s=await(await fetch("https://www.ambassadoribet.com/_internal/gql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})})).json();this.items=this.groupItemsBySlug(s.data.shopItemConnection.edges)}catch(t){console.error("Error fetching items:",t)}}groupItemsBySlug(e){const t={};return e.forEach(({node:s})=>{const a=s.actions[0];if(a&&a.bonus&&a.bonus.reward){const{slug:n,studio:l}=a.bonus.reward.games[0],r=n;t[r]||(t[r]={slug:n,studio:l,items:[],betValues:new Set,amounts:new Set}),t[r].items.push({id:s.id,price:s.price.value,betValue:a.bonus.reward.betValue.value,amount:a.bonus.reward.amount}),t[r].betValues.add(a.bonus.reward.betValue.value),t[r].amounts.add(a.bonus.reward.amount)}}),Object.values(t)}async purchaseItem(e,t){this.loading=!0,this.errorMessages={...this.errorMessages,[t]:""},this.requestUpdate();const s="mutation PurchaseShopItems($input: PurchaseShopItemsInput!) {\n      purchaseShopItems(input: $input) {\n        shopTransaction {\n          userId\n          shopItems { id }\n        }\n      }\n    }";try{const a=extractAuthDataFromCookie();if(!a||!a.accessToken)throw this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].loggIn},new Error("Unable to retrieve authorization data.");const l=await(await fetch("https://www.ambassadoribet.com/_internal/gql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a.accessToken)},body:JSON.stringify({query:s,variables:{input:{shopItemIds:[e]}}})})).json();if(l.errors)l.errors[0].message==="NOT_ENOUGH_MONEY"?this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].notEnoughCoins}:l.errors[0].message==="FORBIDDEN"&&(this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].loggIn});else if(l.data.purchaseShopItems){const r=this.shadowRoot.querySelector("#buy-".concat(t));r.classList.add("success"),setTimeout(()=>{r.classList.remove("success")},3e3)}}catch(a){console.error("Purchase error:",a),this.errorMessages={...this.errorMessages,[t]:this.translations[this.locale].loggIn}}finally{this.loading=!1,this.requestUpdate()}}handleFilterChange(e,t,s){this.selectedOptions={...this.selectedOptions,[e]:{...this.selectedOptions[e],[t]:s}}}getSelectedItem(e){const t=this.selectedOptions[e.slug]||{},s=t.betValue||[...e.betValues][0],a=t.amount||[...e.amounts][0];return e.items.find(n=>n.betValue===s&&n.amount===Number(a))}render(){return c(y||(y=i(['\n      <div class="shop-container">\n        ',"\n      </div>\n    "])),this.items.map(e=>{var t;return c(x||(x=i(['\n            <div class="card">\n              <img\n                src="https://game-assets-tma1-prd.themill.tech/cdn-cgi/image/f=avif,f=auto,w=512,h=288/tm/',"/",'-1024x576?dpr=1&auto=format&fit=max"\n                alt="','"\n              />\n              <div class="card-content">\n                <h3\n                  style="margin-block: .7rem; color: rgba(223, 4, 150, 0.77); font-family: \'Noto Sans Ambassadori Bold\';"\n                >\n                  ','\n                </h3>\n                <div class="filters">\n                  <select\n                    class="bet-value-selector"\n                    @change="','"\n                  >\n                    <option value="" disabled selected>\n                      ',"\n                    </option>\n                    ",'\n                  </select>\n                  <div\n                    @change="','"\n                  >\n                    ','\n                  </div>\n                </div>\n                <button\n                  id="buy-','"\n                  class="buy-button"\n                  ?disabled="','"\n                  @click="','"\n                >\n                  ',"\n                  ","\n                </button>\n                ","\n              </div>\n            </div>\n          "])),e.studio.toLowerCase().replace(/_/g,"-"),e.slug,e.slug,e.slug.replace(/-/g," ").replace(/\b\w/g,s=>s.toUpperCase()),s=>this.handleFilterChange(e.slug,"betValue",s.target.value),this.translations[this.locale].betValue,[...e.betValues].map(s=>c(m||(m=i(['<option value="','">',"</option>"])),s,s)),s=>this.handleFilterChange(e.slug,"amount",s.target.value),[...e.amounts].map(s=>c(b||(b=i(['<input\n                          style="display: none;"\n                          id="',"-",'"\n                          type="radio"\n                          name="amount"\n                          value="','"\n                        />\n                        <label\n                          class="amount-selector"\n                          for="',"-",'"\n                          >',"</label\n                        >"])),e.slug,s,s,e.slug,s,s)),e.slug,this.loading,()=>{const s=this.getSelectedItem(e);s&&this.purchaseItem(s.id,e.slug)},this.translations[this.locale].buy,((t=this.getSelectedItem(e))==null?void 0:t.price)||"",this.errorMessages[e.slug]?c(f||(f=i(['<div class="error-text">\n                      ',"\n                    </div>"])),this.errorMessages[e.slug]):"")}))}}d(u,"styles",I(g||(g=i(['\n    :host {\n      display: block;\n      padding: 16px;\n    }\n    .shop-container {\n      display: grid;\n      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n      gap: 16px;\n    }\n    @media (max-width: 1200px) {\n      .shop-container {\n        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));\n      }\n    }\n    @media (max-width: 500px) {\n      .shop-container {\n        grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));\n      }\n    }\n    .card {\n      border-radius: 8px;\n      overflow: hidden;\n      background: linear-gradient(\n        135deg,\n        rgba(14, 4, 74, 0.4),\n        rgba(14, 4, 74, 0.4)\n      );\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n      padding: 10px;\n      border: 2px solid rgba(71, 47, 80, 1);\n    }\n    .card img {\n      width: 100%;\n      height: 144px;\n      object-fit: cover;\n      border-radius: 8px;\n    }\n    .card-content {\n      padding: 0px 6px 6px 6px;\n    }\n    .filters {\n      margin-bottom: 16px;\n      display: flex;\n      gap: 8px;\n      flex-wrap: wrap;\n      justify-content: center;\n      width: 100%;\n      flex-direction: column;\n      > div {\n        gap: 8px;\n        display: flex;\n        flex-wrap: wrap;\n        flex: 1 1 0;\n      }\n      .amount-selector {\n        color: white;\n        padding: 10px;\n        border-radius: 8px;\n        background-color: rgba(38, 40, 61, 1);\n        opacity: 0.5;\n        flex: 1;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n      }\n    }\n    input:checked + .amount-selector {\n      background-color: rgba(38, 40, 61, 1);\n      opacity: 1;\n    }\n    select {\n      padding: 8px;\n      border-radius: 12px;\n      flex: 1;\n      font-family: "Noto Sans Ambassadori";\n      outline: none;\n      color: white;\n      background: rgba(255, 255, 255, 0.1);\n      border: 2px solid rgba(71, 47, 80, 1);\n      option {\n        background: rgba(14, 4, 74, 0.77);\n        color: white;\n      }\n    }\n    .bet-value-selector {\n    }\n    .buy-button {\n      width: 100%;\n      padding: 12px;\n      border: none;\n      border-radius: 4px;\n      background: linear-gradient(\n        135deg,\n        rgba(223, 4, 150, 0.77),\n        rgba(14, 4, 74, 0.77)\n      );\n      background-size: 200% 200%; /* Larger background size for animation */\n      color: white;\n      cursor: pointer;\n      font-size: 16px;\n      font-family: "Noto Sans Ambassadori";\n      transition: background-position 0.6s ease; /* Smooth transition for background-position */\n    }\n\n    .buy-button:hover {\n      background-position: 100% 100%; /* Shift the gradient on hover */\n    }\n\n    .buy-button:disabled {\n      background: #ccc;\n      cursor: not-allowed;\n    }\n    .buy-button.success {\n      background: #28a745;\n    }\n    .error-text {\n      color: red;\n      font-size: 12px;\n      margin-top: 4px;\n      text-align: center;\n    }\n  '])))),d(u,"properties",{items:{type:Array},selectedOptions:{type:Object},loading:{type:Boolean},errorMessages:{type:Object},locale:{type:String}});customElements.define("shop-component",u);export{k as __vite_legacy_guard};
//# sourceMappingURL=shop.js.map
