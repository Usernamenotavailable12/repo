var u=Object.freeze,m=Object.defineProperty;var $=(s,t,e)=>t in s?m(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var f=(s,t,e)=>$(s,typeof t!="symbol"?t+"":t,e);var c=(s,t)=>u(m(s,"raw",{value:u(t||s.slice())}));function C(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const{LitElement:L,html:p,css:z,unsafeHTML:n}=window.Lit;var y,x,k,w,S;class P extends L{static get properties(){return{data:{type:Object,attribute:!1},points:{type:Number,attribute:!1},maxPoints:{type:Number,attribute:!1},language:{type:String,attribute:!1},isLoggedIn:{type:Boolean,attribute:!1},configid:{type:String},_initialized:{type:Boolean,state:!0},hasScrollLeft:{type:Boolean,state:!0},hasScrollRight:{type:Boolean,state:!0}}}constructor(){var t;super(),this.data={},this.points=0,this.maxPoints=0,this.language="en",this.configid=!1,this.isLoggedIn=((t=extractAuthDataFromCookie())==null?void 0:t.userId)!==void 0,this._initialized=!1,this.hasScrollLeft=!1,this.hasScrollRight=!1}getDateBasedValue(){const t=this.data;if(!(t!=null&&t.dateValues))return"0";const e=new Date,r=new Date(e.getTime()+4*60*60*1e3).toISOString().slice(0,16).replace("T"," ");for(const i of t.dateValues)if(r>=i.startDate&&r<=i.endDate)return i.segmentId;return"0"}async getProgressBarPoints(){var r,i,a,l;const t=this.getDateBasedValue(),e=extractAuthDataFromCookie();if(!e)return 0;const o="\n          query UserTournamentConnection($userId: ID, $tournamentId: ID) {\n            userTournamentConnection(userId: $userId, tournamentId: $tournamentId) {\n              edges {\n                node {\n                  points\n                }\n              }\n            }\n          }\n        ";try{return((l=(a=(i=(r=(await fetchGraphQL(o,{userId:e.userId,tournamentId:t})).data)==null?void 0:r.userTournamentConnection)==null?void 0:i.edges[0])==null?void 0:a.node)==null?void 0:l.points)||0}catch(d){return console.error("Error fetching progress data:",d),0}}async connectedCallback(){super.connectedCallback(),this._initialized||(await this._initializeData(),this._initialized=!0)}async _initializeData(){const t=document.querySelector("#".concat(this.configid));if(t)try{this.data=JSON.parse(t.textContent),this.maxPoints=this.data.breakpoints.reduce((e,o)=>Math.max(e,o.to),0)}catch(e){console.error("Error parsing JSON data:",e),this.data={}}this.language=document.documentElement.lang,this.points=await this.getProgressBarPoints(),this.requestUpdate()}getProgressBarItemsPosition(t){var e;return 100-(100/((e=this.data.breakpoints)==null?void 0:e.length)||0)*(t+1)}getProgressPercentage(){var o,r;if(this.points>this.maxPoints)return 100;if(this.maxPoints===0)return 0;const t=100/((o=this.data.breakpoints)==null?void 0:o.length)||0;let e=0;return(r=this.data.breakpoints)==null||r.forEach((i,a)=>{this.points>=i.from&&this.points<=i.to&&(e=t*a+(this.points-i.from)/(i.to-i.from)*t)}),e}updateScrollState(){const t=this.shadowRoot.querySelector(".cba");if(t){const o=t.scrollLeft,r=t.scrollWidth,i=t.clientWidth;this.hasScrollLeft=o>2,this.hasScrollRight=o+i+2<r}}scrollLeft(){const t=this.shadowRoot.querySelector(".cba");if(t){const o=getComputedStyle(this.shadowRoot.host).getPropertyValue("--progress-item-width").trim(),r=parseFloat(o);t.scrollBy({left:-r,behavior:"smooth"}),setTimeout(()=>this.updateScrollState(),300)}}scrollRight(){const t=this.shadowRoot.querySelector(".cba");if(t){const o=getComputedStyle(this.shadowRoot.host).getPropertyValue("--progress-item-width").trim(),r=parseFloat(o);t.scrollBy({left:r,behavior:"smooth"}),setTimeout(()=>this.updateScrollState(),300)}}firstUpdated(){super.firstUpdated(),this.updateScrollState(),document.addEventListener("user:login",()=>{this.isLoggedIn=!0,this.getProgressBarPoints().then(r=>{this.points=r,this.requestUpdate()})}),document.addEventListener("user:logout",()=>{this.isLoggedIn=!1,this.points=0,this.requestUpdate()});const t=this.shadowRoot.querySelector(".cba"),e=this.shadowRoot.querySelector(".active-bar");if(t&&e){const r=()=>{t.getBoundingClientRect(),e.getBoundingClientRect();const a=e.offsetLeft-t.offsetLeft-t.clientWidth/2+e.clientWidth/2;t.scrollTo({left:a,behavior:"smooth"})},i=a=>{a.propertyName==="left"&&(r(),e.removeEventListener("transitionend",i))};e.addEventListener("transitionend",i)}t.addEventListener("scroll",()=>this.updateScrollState());const o=new ResizeObserver(()=>this.updateScrollState());o.observe(t),this._resizeObserver=o}render(){var t,e,o,r,i,a,l,d,h,b;return p(S||(S=c(['\n    <div class="prodedushka">\n      <div\n        class="scroll-left"\n        style="opacity: ',';"\n      >\n        <button @click="','">\n          <img\n            src="https://images.takeshape.io/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/2db8c163-5099-4ac5-abd7-f21a7a0b27f8/arrow-left.svg"\n          />\n        </button>\n      </div>\n      <div\n        class="scroll-right"\n        style="opacity: ','"\n      >\n        <button @click="','">\n          <img\n            src="https://images.takeshape.io/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/8d7d55e7-5ea4-4431-a0e3-e56f2a80ac3f/arrow-left.svg"\n          />\n        </button>\n      </div>\n\n      <div\n        class="logincomponent"\n        style=',"\n      >\n        ",'\n      </div>\n\n      <div\n        class="complete-component"\n        style=',"\n      >\n        ",'\n      </div>\n\n      <div class="cba" tabindex="-1" style="--pt: ','%">\n        ','\n        <div\n          style="--breakpoint-length: ','"\n          class="progress-bar-builder-cont"\n        >\n          <div class="progress-title">\n            <div class="uptitle-text">\n              ','\n            </div>\n\n            <div class="abs">\n              ','\n            </div>\n          </div>\n\n          <div class="progress-container">\n            <div class="active-progress-container">\n              <div\n                style="width: ','%"\n                class="active-progress"\n              ></div>\n            </div>\n\n            <div\n              class="active-bar"\n              style="left: max(var(--min-left-side), ','%)"\n            >\n              ',' â‚¾\n            </div>\n\n            <div class="abs">\n              ','\n            </div>\n          </div>\n\n          <div class="progress-bottom">\n            <div class="bottomtitle-text">\n              ','\n            </div>\n\n            <div class="abs">\n              ',"\n            </div>\n          </div>\n        </div>\n        ","\n      </div>\n      </div>\n    "])),this.hasScrollLeft?"1":"0",()=>this.scrollLeft(),this.hasScrollRight?"1":"0",()=>this.scrollRight(),this.isLoggedIn?"opacity: 0; pointer-events: none;":"opacity: 1;",n(((t=this.data.components)==null?void 0:t.logoutComponent[this.language])||""),this.points>=this.maxPoints?"visibility: visible;":"visibility: hidden; pointer-events: none;",n(((e=this.data.components)==null?void 0:e.complateComponent[this.language])||""),this.getProgressPercentage(),n(((o=this.data.components)==null?void 0:o.beforeComponent)||""),((r=this.data.breakpoints)==null?void 0:r.length)||0,n((i=this.data.components)==null?void 0:i.upTitleContent[this.language]),(a=this.data.breakpoints)==null?void 0:a.map((g,v)=>p(x||(x=c(['<div\n                    style="right: ','%"\n                  >\n                    ',"\n                  </div>"])),this.getProgressBarItemsPosition(v),n(g.topContent))),this.getProgressPercentage(),this.getProgressPercentage(),this.points,(l=this.data.breakpoints)==null?void 0:l.map((g,v)=>p(k||(k=c(['<div\n                    style="right: ','%"\n                  >\n                    ',"\n                  </div>"])),this.getProgressBarItemsPosition(v),n(g.barckepointContent))),n((d=this.data.components)==null?void 0:d.bottomTitleContent[this.language]),(h=this.data.breakpoints)==null?void 0:h.map((g,v)=>p(w||(w=c(['<div\n                    style="right: ','%"\n                  >\n                    ',"\n                  </div>"])),this.getProgressBarItemsPosition(v),n(g.bottomContent))),n(((b=this.data.components)==null?void 0:b.afterComponent)||""))}}f(P,"styles",z(y||(y=c(['\n    .prodedushka {\n      position: var(--host-position);\n    }\n\n    .progress-container {\n      height: var(--progress-height);\n      background-color: var(--progress-background-color);\n      border-radius: var(--progress-border-radius);\n      border: var(--progress-border-width) solid var(--progress-border-color);\n      z-index: var(--progress-container-z-index);\n      position: var(--progress-container-position);\n    }\n\n    .progress-container .active-progress {\n      width: var(--active-progress-width);\n      height: var(--active-progress-height);\n      background-color: var(--progress-active-color);\n      border-radius: inherit;\n      transition: width var(--progress-transition-duration)\n        var(--progress-transition-easing);\n      z-index: var(--progress-active-z-index);\n      inset: var(--active-progress-inset);\n      position: var(--active-progress-position);\n      \n    }\n\n    .progress-container .active-progress::before {\n      content: "";\n      position: absolute;\n      inset: 0;\n      background: var(--grad-mask-abc);\n      clip-path: polygon(0 0, var(--pt) 0,  var(--pt) 100%, 0% 100%);\n    }\n\n    .progress-container,\n    .progress-bottom,\n    .progress-title {\n      display: var(--progress-container-display);\n      flex-direction: var(--progress-container-flex-direction);\n      min-height: var(--progress-min-height);\n      position: var(--progress-container-position);\n      box-sizing: var(--progress-container-box-sizing);\n      height: var(--progress-container-height);\n    }\n\n    .abs > :last-child {\n      transform: var(--abs-last-child-transform);\n    }\n\n    .abs {\n      position: var(--abs-position);\n      inset: var(--abs-inset);\n      display: var(--abs-display);\n    }\n\n    .abs > * {\n      position: var(--abs-child-position);\n      transform: var(--abs-child-transform);\n    }\n\n    .active-progress-container {\n      position: var(--active-progress-container-position);\n      width: var(--active-progress-container-width);\n      height: var(--active-progress-container-height);\n      border-radius: inherit;\n      overflow: var(--active-progress-container-overflow);\n      transform: var(--active-progress-container-transform);\n    }\n\n    .progress-text-container {\n      display: var(--progress-text-container-display);\n      gap: var(--progress-item-gap);\n      align-items: var(--progress-text-container-align-items);\n    }\n\n    .progress-bar-builder-cont {\n      min-width: calc(var(--progress-item-width) * var(--breakpoint-length, 5));\n      width: var(--progress-bar-builder-cont-width);\n      display: flex;\n      flex-direction: column;\n      gap: var(--progress-item-gap);\n    }\n\n    .cba {\n      display: var(--cba-display);\n      overflow-x: var(--cba-overflow-x);\n      scrollbar-width: var(--cba-scrollbar-width);\n      scroll-behavior: var(--cba-scroll-behavior);\n      -ms-overflow-style: var(--cba-ms-overflow-style);\n      padding: var(--cba-padding);\n      overflow-y: hidden;\n    }\n\n    .cab::-webkit-scrollbar {\n      display: none;\n    }\n\n    .active-bar {\n      position: var(--active-bar-position);\n      top: var(--active-bar-top);\n      transform: var(--active-bar-transform);\n\n      display: var(--active-bar-display);\n      height: var(--active-bar-height);\n      padding: var(--active-bar-padding);\n      justify-content: var(--active-bar-justify-content);\n      align-items: var(--active-bar-align-items);\n      flex-shrink: var(--active-bar-flex-shrink);\n\n      border-radius: var(--active-bar-border-radius);\n      border: var(--active-bar-border);\n      background: var(--active-bar-background);\n\n      z-index: var(--active-bar-z-index);\n      transition: left var(--progress-transition-duration)\n        var(--progress-transition-easing);\n\n      color: var(--active-bar-color);\n      text-align: var(--active-bar-text-align);\n      font-family: var(--active-bar-font-family);\n      font-size: var(--active-bar-font-size);\n    }\n\n    .active-bar::after {\n      content: var(--active-bar-after-content);\n      background: var(--active-bar-after-background);\n      background-size: var(--active-bar-after-background-size);\n      background-position: var(--active-bar-after-background-position);\n      background-repeat: var(--active-bar-after-background-repeat);\n      position: var(--active-bar-after-position);\n      width: var(--active-bar-after-width);\n      right: var(--active-bar-after-right);\n      transform: var(--active-bar-after-transform);\n      height: var(--active-bar-after-height);\n    }\n\n    .scroll-left,\n    .scroll-right {\n      position: var(--scroll-position);\n      top: var(--scroll-top);\n      transform: var(--scroll-transform);\n      color: var(--scroll-color);\n      padding: var(--scroll-padding);\n      border-radius: var(--scroll-border-radius);\n      cursor: var(--scroll-cursor);\n      z-index: var(--scroll-z-index);\n      transition: var(--scroll-transition);\n\n      display: var(--scroll-display);\n      width: var(--scroll-width);\n      height: var(--scroll-height);\n      padding: var(--scroll-padding-vertical);\n      justify-content: var(--scroll-justify-content);\n      align-items: var(--scroll-align-items);\n      flex-shrink: var(--scroll-flex-shrink);\n    }\n\n    .scroll-left {\n      background: var(--scroll-left-background);\n      left: var(--scroll-left-left);\n    }\n    .scroll-right {\n      background: var(--scroll-right-background);\n      right: var(--scroll-right-right);\n    }\n\n    .scroll-left button,\n    .scroll-right button {\n      background-color: var(--scroll-button-background-color);\n      border: var(--scroll-button-border);\n      border-radius: var(--scroll-button-border-radius);\n      aspect-ratio: var(--scroll-button-aspect-ratio);\n      width: var(--scroll-button-width);\n      justify-content: var(--scroll-button-justify-content);\n      align-items: var(--scroll-button-align-items);\n      display: var(--scroll-button-display);\n      border: var(--scroll-button-border-none);\n      color: var(--scroll-button-color);\n    }\n    .scroll-right {\n      right: 0;\n    }\n\n    .logincomponent {\n      background: var(--login-component-background);\n      display: var(--login-component-display);\n      position: var(--login-component-position);\n      inset: var(--login-component-inset);\n      justify-content: var(--login-component-justify-content);\n      align-items: var(--login-component-align-items);\n      z-index: var(--login-component-z-index);\n      transition: var(--login-component-transition);\n    }\n\n    .complete-component {\n      background: var(--complete-component-background);\n      display: var(--complete-component-display);\n      position: var(--complete-component-position);\n      inset: var(--complete-component-inset);\n      justify-content: var(--complete-component-justify-content);\n      align-items: var(--complete-component-align-items);\n      z-index: var(--complete-component-z-index);\n      transition: var(--complete-component-transition);\n    }\n  ']))));customElements.define("progressbar-builder",P);export{C as __vite_legacy_guard};
//# sourceMappingURL=progressbar.js.map
