var c=Object.freeze,w=Object.defineProperty;var i=(d,a)=>c(w(d,"raw",{value:c(a||d.slice())}));function S(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const{LitElement:v,html:r,css:x}=window.Lit;var l,b,m,g,h,f,p,u;customElements.define("game-search",class extends v{static get styles(){return x(l||(l=i(["\n      :host {\n        display: block;\n        font-family: 'Noto Sans Ambassadori';\n        padding: 10px;\n        margin: 0;\n        background: transparent;\n      }\n      .studio-logo {\n        width: 20px !important;\n        height: 20px !important;\n        padding-right: 5px;\n      }\n      .loading {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 100vh;\n      }\n      .spinner {\n        width: 64px;\n        height: 64px;\n        border-radius: 50%;\n      }\n      .spinner::before {\n        content: '';\n        width: 64px;\n        margin-left: -4px;\n        margin-top: -4px;\n        height: 64px;\n        display: block;\n        border: 4px solid transparent;\n        border-top-color: #ff0099;\n        border-radius: 50%;\n        animation: spin 1s linear infinite;\n      }\n      .spinner {\n        background-size: contain !important;\n        background-repeat: no-repeat !important;\n        background-image: url(\"https://images.themill.tech/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/aaeef128-13e0-4317-a4e9-815bb063ebbd/spinner-logo-2-bat.png\") !important;\n      }\n      @keyframes spin {\n        to { transform: rotate(360deg); }\n      }\n      .content.hidden {\n        display: none;\n      }\n      .search-input {\n        width: 100%;\n        padding: 10px;\n        height: 35px;\n        padding-left: 15px; /* Space for the icon */\n        font-size: 16px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 64px;\n        box-sizing: border-box;\n        background: rgba(28, 9, 26, 1);\n        color: rgba(255, 255, 255, 0.86);\n      }\n            .search-input:focus {\n        outline: none;\n        border-color: rgba(255, 255, 255, 0.2);\n        box-shadow: 0 0 5px rgba(255, 255, 255, 0.2);\n      }\n      .studio-filters {\n        margin-bottom: 20px;\n      }\n      .studio-filters h2 {\n        font-size: 18px;\n        margin-bottom: 15px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        user-select: none;\n        color: white;\n        justify-content: center;\n      }\n      .triangle {\n        display: inline-block;\n        width: 0;\n        height: 0;\n        border: solid 8px;\n        border-color: transparent transparent transparent #ff05a8;\n        margin-right: 8px;\n        transition: transform 0.3s ease;\n      }\n      .studio-filters.collapsed .triangle {\n        transform: rotate(-90deg);\n      }\n      .studio-filters:not(.collapsed) .triangle {\n        transform: rotate(90deg);\n      }\n      .filter-content {\n        max-height: 0;\n        overflow: hidden;\n        transition: max-height 0.3s ease-out;\n        display: flex !important;\n        gap: 10px;\n        flex-wrap: wrap;\n      }\n      .studio-filters:not(.collapsed) .filter-content {\n        display: flex;\n        max-height: 1300px;\n        flex-wrap: wrap;\n      }\n      .studio-filters label {\n        display: inline-flex;\n        align-items: center;\n        color: rgba(255,255,255,0.86);\n        padding: 7px !important;\n        font-size: 10px;\n        background: #0e1215 !important;\n        border-radius: 5px;\n        flex: 1 1 calc(25% - 1rem);\n        min-width: 130px;\n        box-sizing: border-box;\n      }\n      .studio-filters input {\n        width: 15px;\n        height: 15px;\n        margin-right: 5px;\n        opacity: .2;\n        cursor: pointer;\n      }\n      .studio-filters input:checked {\n        opacity: 1;\n      }\n      .studio-filters img {\n        height: 24px;\n      }\n      .game-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\n        gap: 10px;\n      }\n      .game-card {\n        aspect-ratio: 16/9 !important;\n        cursor: pointer;\n        transition: transform 0.2s;\n      }\n      .game-card:hover {\n        transform: scale(1.05);\n      }\n      .game-card img {\n        width: 100%;\n        min-height: 100%;\n        object-fit: cover;\n        border-radius: 4px;\n      }\n      .game-card img[data-src] {\n        background: #eee;\n      }\n      .game-card p {\n        text-align: center;\n        margin: 10px 0 0;\n        font-size: 14px;\n        font-weight: 500;\n        display: none;\n      }\n      .sentinel {\n        height: 20px;\n      }\n      .no-games {\n        text-align: center;\n        color: white;\n        font-size: 16px;\n        padding: 20px;\n      }\n    "])))}static get properties(){return{games:{type:Array},visibleGames:{type:Array},selectedStudios:{type:Array},searchTerm:{type:String},isCollapsed:{type:Boolean},isLoading:{type:Boolean},error:{type:String},batchSize:{type:Number},loadedCount:{type:Number}}}constructor(){super(),this.games=[],this.visibleGames=[],this.selectedStudios=[],this.searchTerm="",this.isCollapsed=!1,this.isLoading=!1,this.error=null,this.batchSize=20,this.loadedCount=0,this.scrollObserver=null,this.studioLogos={AMUSNET:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/68c19744-2a71-47a1-8f1c-7f64328428cb/amusnet.svg?auto=format",PRAGMATIC_PLAY:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/e69336a8-767c-469f-ad09-d11d4be4eb23/pragmatic-play-new.svg?auto=format",EGT:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/ce212069-c723-4fbe-8447-d68e05e7e649/egt-digital.svg?auto=format",EVOLUTION:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/48400d07-75e8-4222-90bf-a82030c402d7/evolution.svg?auto=format",ISOFTBET:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/cc43280f-a102-4dab-808b-e2758a5f8e40/isoftbet.svg?auto=format",PLAYNGO:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/70f61c04-1ef1-45db-8335-288b687aa556/playngo.svg?auto=format",PATEPLAY:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/97126ec8-9442-461f-a6b1-59129a73c511/Pateplay-mobile.svg?auto=format",HACKSAW_GAMING:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/c1de173e-7cc3-427c-8be5-c86afa671836/hacksaw-gaming-new.svg?auto=format",RELAX:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/15cfab18-642b-4b71-8c03-2d229f976949/relax-gaming-new.svg?auto=format",NOLIMIT_CITY:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/38477bfc-2154-4a1c-9cbc-e07604657be3/nolimit-new.svg?auto=format",IRON_DOG:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/3c776c91-a0f6-4a91-b076-f1c812ba2af0/iron-dog-studio-new.svg?auto=format",RED_TIGER:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/c488b263-b256-4bae-962f-fa5c670d2062/red-tiger-gaming.svg?auto=format",ELK:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/7bb2f119-86e2-4926-a172-6bb0ed70394a/elk.svg?auto=format",GAMING_CORPS:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/22b75c8e-98fc-4dd8-af9e-719d80a4a5ce/gaming-corps-sq.svg?auto=format",NETENT:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/27b1fa65-b5d2-4279-ae33-b5c11e1d9d33/netent-new.svg?auto=format",PUSH_GAMING:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/d8271537-9725-4721-972e-ad7bbc3fcef7/push-gaming-new.svg?auto=format",WIZARD_GAMES:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/b22bc9a4-64ae-4ae8-aa68-943faf155d4f/wizard-games.svg?auto=format",YGGDRASIL:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/c9b2ccbe-3a07-4d74-85a6-fe6ca5256b5e/yggdrasil-gaming.svg?auto=format",PRINT:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/9871045d-1654-4dcb-8ec7-64543d90f8bb/print-studios-20.svg?auto=format",BIG_TIME_GAMING:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/a0776c05-7aed-4554-8f26-e9f98858fb6c/big-time-gaming.svg?auto=format",BGAMING:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/f9c1b7e4-e302-42c1-abbb-d19a7e074182/bgaming-mobile.svg?auto=format",SPINOMENAL:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/61a6a786-e560-400d-801a-6c49ee5d3dc0/spinomenal-casino-slots-mobile.svg?auto=format",FANTASMA_GAMES:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/bf886cf5-ad69-44c6-ae0f-dabe6610d8ba/fantasma-games-new.svg?auto=format",QUICKSPIN:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/2dedbccf-d612-4e14-b2c5-30219aa64fdf/quickspin.svg?auto=format",LIGHT_WONDER:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/049569ec-d178-47ec-b2d3-f3178d05d2d3/light-wonder-new.svg?auto=format",RED_RAKE:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/abe99035-578d-4f52-ad79-2a2cf8c5ac71/red-rake-gaming.svg?auto=format",ONEXTWOGAMING:"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/3417cda9-63f1-4258-ac9a-509bbe4e142b/1x2gaming.svg?auto=format"},this.CACHE_KEY="gameSearchData"}connectedCallback(){super.connectedCallback(),this.fetchGames()}disconnectedCallback(){super.disconnectedCallback(),this.scrollObserver&&(this.scrollObserver.disconnect(),this.scrollObserver=null)}async fetchGames(){const a=this.getCachedGames();a?(this.games=a,this.updateVisibleGames(),this.isLoading=!1):this.isLoading=!0;try{const t=await(await fetch("https://www.ambassadoribet.com/_internal/gql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n            query LobbyConnection($lobbyId: ID) {\n              lobbyConnection(lobbyId: $lobbyId) {\n                edges {\n                  node {\n                    brandGames {\n                      slug\n                      studio\n                      name\n                    }\n                  }\n                }\n              }\n            }\n          ",variables:{lobbyId:"ab_all-games"}})})).json();if(!t.data||!t.data.lobbyConnection||!t.data.lobbyConnection.edges)throw new Error("Invalid response structure");const s=t.data.lobbyConnection.edges.flatMap(o=>o.node.brandGames);JSON.stringify(s)!==JSON.stringify(this.games)&&(this.games=s,this.setCachedGames(s),this.updateVisibleGames()),this.isLoading=!1,this.error=null}catch(e){console.error("Error fetching games:",e),a||(this.error="Error loading games"),this.isLoading=!1}}getCachedGames(){const a=localStorage.getItem(this.CACHE_KEY);return a?JSON.parse(a):null}setCachedGames(a){try{localStorage.setItem(this.CACHE_KEY,JSON.stringify(a))}catch(e){console.error("Error saving to localStorage:",e)}}handleSearch(a){this.searchTerm=a.target.value,this.loadedCount=0,this.updateVisibleGames()}toggleStudioFilters(){this.isCollapsed=!this.isCollapsed}handleStudioToggle(a){const e=a.target.value;this.selectedStudios=a.target.checked?[...this.selectedStudios,e]:this.selectedStudios.filter(t=>t!==e),this.loadedCount=0,this.updateVisibleGames()}launchGame(a,e){window.TMA.navigate("GAME",{gameStudio:a.toLowerCase(),gameSlug:e})}updateVisibleGames(){const a=this.games.filter(t=>{const s=this.selectedStudios.length===0||this.selectedStudios.includes(t.studio),o=t.name.toLowerCase().includes(this.searchTerm.toLowerCase());return s&&o});if(a.length===0){this.visibleGames=[],this.loadedCount=0,this.scrollObserver&&(this.scrollObserver.disconnect(),this.scrollObserver=null);return}const e=a.slice(0,this.loadedCount+this.batchSize);if(e.length===this.visibleGames.length&&this.loadedCount>=a.length){this.scrollObserver&&(this.scrollObserver.disconnect(),this.scrollObserver=null);return}this.visibleGames=e,this.loadedCount=this.visibleGames.length}setupInfiniteScroll(){const a=this.shadowRoot.querySelector(".sentinel");if(!a)return;this.scrollObserver&&this.scrollObserver.disconnect();const e=this.games.filter(t=>{const s=this.selectedStudios.length===0||this.selectedStudios.includes(t.studio),o=t.name.toLowerCase().includes(this.searchTerm.toLowerCase());return s&&o});e.length<=this.loadedCount||e.length===0||(this.scrollObserver=new IntersectionObserver(t=>{t[0].isIntersecting&&this.updateVisibleGames()},{rootMargin:"100px"}),this.scrollObserver.observe(a))}updated(a){(a.has("games")||a.has("visibleGames")||a.has("selectedStudios")||a.has("searchTerm"))&&(this.setupLazyLoading(),this.setupInfiniteScroll())}setupLazyLoading(){const a=this.shadowRoot.querySelectorAll("img[data-src]");if("loading"in HTMLImageElement.prototype)a.forEach(e=>{e.src=e.dataset.src,e.removeAttribute("data-src")});else{const e=new IntersectionObserver((t,s)=>{t.forEach(o=>{if(o.isIntersecting){const n=o.target;n.src=n.dataset.src,n.removeAttribute("data-src"),s.unobserve(n)}})},{rootMargin:"0px 0px 100px 0px"});a.forEach(t=>e.observe(t))}}render(){if(this.isLoading)return r(b||(b=i(['\n        <div class="loading">\n          <div class="spinner"></div>\n        </div>\n      '])));if(this.error)return r(m||(m=i(['\n        <div class="loading">\n          <p>',"</p>\n        </div>\n      "])),this.error);const a=[...new Set(this.games.map(e=>e.studio))];return r(u||(u=i(['\n      <div class="content">\n        <input\n          class="search-input"\n          type="text"\n          placeholder="Search..."\n          .value=',"\n          @input=",'\n        >\n        <div class="studio-filters collapsed','">\n          <h2 @click=','>\n            <span class="triangle"></span>\n            Studio\n          </h2>\n          <div class="filter-content">\n            ','\n          </div>\n        </div>\n        <div class="game-grid">\n          ',"\n          ","\n        </div>\n      </div>\n    "])),this.searchTerm,this.handleSearch,this.isCollapsed?"collapsed":"",this.toggleStudioFilters,a.map(e=>r(g||(g=i(['\n              <label>\n                <input\n                  type="checkbox"\n                  .value=',"\n                  ?checked=","\n                  @change=",'\n                >\n                <img\n                  class="studio-logo"\n                  src=',"\n                  alt=","\n                >","\n              </label>\n            "])),e,this.selectedStudios.includes(e),this.handleStudioToggle,this.studioLogos[e]||"https://via.placeholder.com/100x40?text=Studio",e,e.replace(/_/g," "))),this.visibleGames.length===0?r(h||(h=i(['<p class="no-games">No games found</p>']))):this.visibleGames.map(e=>{const t=e.studio.replace(/_/g,"-").toLowerCase(),s="https://game-assets-tma1-prd.themill.tech/cdn-cgi/image/f=avif,f=auto,w=512,h=288/tm/".concat(t,"/").concat(e.slug,"-1024x576?dpr=1&auto=format&fit=max");return r(f||(f=i(['\n                  <div\n                    class="game-card"\n                    @click=',"\n                  >\n                    <img\n                      data-src=","\n                      alt=",'\n                      loading="lazy"\n                    >\n                    <p>',"</p>\n                  </div>\n                "])),()=>this.launchGame(e.studio,e.slug),s,e.name,e.name)}),this.visibleGames.length>0?r(p||(p=i(['<div class="sentinel"></div>']))):"")}});export{S as __vite_legacy_guard};
//# sourceMappingURL=search.js.map
