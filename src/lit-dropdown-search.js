var r=Object.freeze,m=Object.defineProperty;var s=(o,e)=>r(m(o,"raw",{value:r(e||o.slice())}));function w(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}const{LitElement:u,html:a,css:b}=window.Lit;var n,l,d,c,h,p;customElements.define("dropdown-game-search",class extends u{static get styles(){return b(n||(n=s(["\n      :host {\n        display: inline-flex;\n        font-family: 'Noto Sans Ambassadori';\n        padding: 10px;\n        margin: 0;\n        background: transparent;\n        justify-content: end;\n        position: relative;\n        width: 300px;\n        height: 44px;\n      }\n      .search-input {\n        width: 320px;\n        padding: 10px;\n        height: 44px;\n        padding-left: 40px; /* Space for the icon */\n        font-size: 16px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 64px;\n        box-sizing: border-box;\n        background: rgba(28, 9, 26, 1);\n        color: #fff;\n        font-family: 'Noto Sans Ambassadori';\n        width: 200px;\n        transition: width 0.3s ease;\n      }\n      .search-input-icon {\n        content: url('https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/298a2099-37a5-41a0-83cb-c4a3f8e3dfee/footer-search.svg');\n        display: inline-block;\n        position: absolute;\n        inset: 0px;\n        width: 17px;\n        top: 50%;\n        transform: translateY(-50%);\n        left: 125px;\n        transition: left 0.3s ease;\n      }\n      :host:has(.search-input:focus)  .search-input-icon {\n        left: 25px; /* Adjust icon position on focus */\n      }\n      .search-input:focus {\n        outline: none;\n        border-color: rgba(255, 255, 255, 0.2);\n        box-shadow: 0 0 5px rgba(255, 255, 255, 0.2);\n        width: 300px; /* Expand to full width on focus */\n      }\n      .search-input:focus + .dropdown,\n      .dropdown.visible {\n        display: block;\n      }\n      .dropdown {\n        display: none;\n        position: absolute;\n        top: 100%;\n        left: 0;\n        right: 0;\n        max-height: 320px;\n        width: 320px;\n        overflow-y: auto;\n        background: rgba(28, 9, 26, 1);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 16px;\n        z-index: 1000;\n        padding: 5px;\n        scrollbar-width: none;\n      }\n      .game-item {\n        display: flex;\n        align-items: center;\n        padding: 10px;\n        cursor: pointer;\n        transition: background 0.2s;\n        scale: 1.03;\n      }\n      .game-item:hover {\n        background: #2F0E2C;\n      }\n      .game-item:hover:after {\n        content: url(\"https://www.ambassadoribet.com/_internal/ts-images/5da2b4d5-59f6-412a-82c3-f6a272b532be/dev/32ba5fe7-b5e4-41af-bb69-34e8ad1b5941/arrow-right.svg\");\n      }\n      .game-item img {\n        width: 80px;\n        height: 45px;\n        object-fit: cover;\n        border-radius: 4px;\n        margin-right: 10px;\n      }\n      .game-info {\n        flex: 1;\n      }\n      .game-info .studio-name {\n        font-size: 12px;\n        color: rgb(255, 255, 255, .6);\n      }\n      .game-info .game-name {\n        font-size: 14px;\n        font-weight: 500;\n        color: rgb(255, 255, 255, 1);\n      }\n      .loading {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        padding: 20px;\n      }\n      .spinner {\n        width: 32px;\n        height: 32px;\n        border: 3px solid #f3f3f3;\n        border-top: 3px solid #ff0099;\n        border-radius: 50%;\n        animation: spin 1s linear infinite;\n      }\n      @keyframes spin {\n        to { transform: rotate(360deg); }\n      }\n      .no-games {\n        text-align: center;\n        color: #333;\n        font-size: 14px;\n        padding: 20px;\n      }\n      .error {\n        text-align: center;\n        color: #ff0000;\n        font-size: 14px;\n        padding: 20px;\n      }\n    "])))}static get properties(){return{games:{type:Array},visibleGames:{type:Array},searchTerm:{type:String},isLoading:{type:Boolean},error:{type:String},isDropdownVisible:{type:Boolean},locale:{type:String}}}constructor(){super(),this.games=[],this.visibleGames=[],this.searchTerm="",this.isLoading=!1,this.error=null,this.isDropdownVisible=!1,this.CACHE_KEY="gameSearchData",this.locale="en",this.placeholders={en:"Search...",ka:"ძებნა...",ru:"Поиск...",tr:"Ara..."}}connectedCallback(){super.connectedCallback(),document.addEventListener("click",this.handleDocumentClick.bind(this)),this.loadCachedGames()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("click",this.handleDocumentClick.bind(this))}handleDocumentClick(e){this.shadowRoot.contains(e.target)||(this.isDropdownVisible=!1)}handleInputFocus(){this.isDropdownVisible=!0,this.loadCachedGames(),this.fetchGames()}handleInputBlur(){setTimeout(()=>{!this.shadowRoot.querySelector(".search-input:focus")&&!this.shadowRoot.querySelector(".dropdown:hover")&&(this.isDropdownVisible=!1)},200)}loadCachedGames(){const e=this.getCachedGames();e&&(this.games=e,this.updateVisibleGames(),this.isLoading=!1)}async fetchGames(){this.games.length||(this.isLoading=!0),this.requestUpdate();try{const t=await(await fetch("https://www.ambassadoribet.com/_internal/gql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n            query LobbyConnection($lobbyId: ID) {\n              lobbyConnection(lobbyId: $lobbyId) {\n                edges {\n                  node {\n                    brandGames {\n                      slug\n                      studio\n                      name\n                    }\n                  }\n                }\n              }\n            }\n          ",variables:{lobbyId:"ab_all-games"}})})).json();if(!t.data||!t.data.lobbyConnection||!t.data.lobbyConnection.edges)throw new Error("Invalid response structure");const i=t.data.lobbyConnection.edges.flatMap(g=>g.node.brandGames);JSON.stringify(i)!==JSON.stringify(this.games)&&(this.games=i,this.setCachedGames(i),this.updateVisibleGames()),this.isLoading=!1,this.error=null}catch(e){console.error("Error fetching games:",e),this.games.length||(this.error="Error loading games"),this.isLoading=!1}}getCachedGames(){try{const e=localStorage.getItem(this.CACHE_KEY);return e?JSON.parse(e):null}catch(e){return console.error("Error retrieving cached games:",e),null}}setCachedGames(e){try{localStorage.setItem(this.CACHE_KEY,JSON.stringify(e))}catch(t){console.error("Error saving to localStorage:",t)}}handleSearch(e){this.searchTerm=e.target.value,this.isDropdownVisible=!0,this.updateVisibleGames()}launchGame(e,t){try{if(window.TMA&&typeof window.TMA.navigate=="function")window.TMA.navigate("GAME",{gameStudio:e.toLowerCase(),gameSlug:t}),console.log("Navigating to game:",{gameStudio:e.toLowerCase(),gameSlug:t});else{console.warn("TMA.navigate is not available, falling back to URL redirect");const i="/game/".concat(e.toLowerCase().replace(/_/g,"-"),"/").concat(t);window.location.href=i,console.log("Redirecting to:",i)}this.isDropdownVisible=!1}catch(i){console.error("Error launching game:",i)}}updateVisibleGames(){this.visibleGames=this.games.filter(e=>e.name.toLowerCase().includes(this.searchTerm.toLowerCase()))}render(){return a(p||(p=s(['\n      <div class="search-input-icon"></div>\n      <input\n        class="search-input"\n        type="text"\n        placeholder=',"\n        .value=","\n        @focus=","\n        @blur=","\n        @input=",'\n      >\n      <div class="dropdown ','">\n        ',"\n      </div>\n    "])),this.placeholders[this.locale]||this.placeholders.en,this.searchTerm,this.handleInputFocus,this.handleInputBlur,this.handleSearch,this.isDropdownVisible?"visible":"",this.isLoading&&!this.games.length?a(l||(l=s(['\n              <div class="loading">\n                <div class="spinner"></div>\n              </div>\n            ']))):this.error?a(d||(d=s(['\n                <div class="error">',"</div>\n              "])),this.error):this.visibleGames.length===0?a(c||(c=s(['\n                  <p class="no-games">No games found</p>\n                ']))):this.visibleGames.map(e=>{const t=e.studio.replace(/_/g,"-").toLowerCase(),i="https://game-assets-tma1-prd.themill.tech/cdn-cgi/image/f=avif,f=auto,w=512,h=288/tm/".concat(t,"/").concat(e.slug,"-1024x576?dpr=1&auto=format&fit=max");return a(h||(h=s(['\n                    <div\n                      class="game-item"\n                      @click=',"\n                    >\n                      <img\n                        src=","\n                        alt=",'\n                        loading="lazy"\n                      >\n                      <div class="game-info">\n                        <div class="studio-name">','</div>\n                        <div class="game-name">',"</div>\n                      </div>\n                    </div>\n                  "])),()=>this.launchGame(e.studio,e.slug),i,e.name,e.studio.replace(/_/g," "),e.name)}))}});export{w as __vite_legacy_guard};
//# sourceMappingURL=search-2.js.map
